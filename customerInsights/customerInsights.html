<!DOCTYPE html>
<!-- Created as an example by https://github.com/mcphee11 Version 4.1 -->
<html>

<head>
  <meta name="robots" content="noindex" />
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title></title>
  <meta name="Template" content="" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- Genesys CSS https://spark.genesys.com/ In PROD set a version https://www.jsdelivr.com/package/npm/genesys-spark-components -->
  <link no-cors
    href="https://cdn.jsdelivr.net/npm/genesys-spark-components@4.138.2/dist/genesys-webcomponents/genesys-webcomponents.min.css"
    rel="stylesheet" />
  <script no-cors type="module"
    src="https://cdn.jsdelivr.net/npm/genesys-spark-components@4.138.2/dist/genesys-webcomponents/genesys-webcomponents.esm.min.js"></script>
  <!-- Genesys SDK info https://developer.genesys.cloud/  In PROD set a version -->
  <script src="https://sdk-cdn.mypurecloud.com/javascript/latest/purecloud-platform-client-v2.min.js"></script>
  <script src="https://sdk-cdn.mypurecloud.com/client-apps/2.6.7/purecloud-client-app-sdk.js"></script>
  <!-- custom charts -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.5.0/dist/chart.umd.min.js"></script>
  <script src="./index.js"></script>
</head>

<body>
  <div style="display: inline-flex" class="header">
    <gux-dropdown filter-type="starts-with" placeholder="UTC-00:00" id="timeZone" style="width: 150px; padding: 8px">
      <gux-listbox aria-label="Time Zone">
        <gux-option value="-12:00">UTC-12:00</gux-option><gux-option value="-11:00">UTC-11:00</gux-option><gux-option
          value="-10:00">UTC-10:00</gux-option><gux-option value="-09:30">UTC-09:30</gux-option><gux-option
          value="-09:00">UTC-09:00</gux-option><gux-option value="-08:00">UTC-08:00</gux-option><gux-option
          value="-07:00">UTC-07:00</gux-option><gux-option value="-06:00">UTC-06:00</gux-option><gux-option
          value="-05:00">UTC-05:00</gux-option><gux-option value="-04:00">UTC-04:00</gux-option><gux-option
          value="-03:30">UTC-03:30</gux-option><gux-option value="-03:00">UTC-03:00</gux-option><gux-option
          value="-02:00">UTC-02:00</gux-option><gux-option value="-01:00">UTC-01:00</gux-option><gux-option
          value="-00:00">UTC+00:00</gux-option><gux-option value="+00:00">UTC+00:00</gux-option><gux-option
          value="+01:00">UTC+01:00</gux-option><gux-option value="+02:00">UTC+02:00</gux-option><gux-option
          value="+03:00">UTC+03:00</gux-option><gux-option value="+03:30">UTC+03:30</gux-option><gux-option
          value="+04:00">UTC+04:00</gux-option><gux-option value="+04:30">UTC+04:30</gux-option><gux-option
          value="+05:00">UTC+05:00</gux-option><gux-option value="+05:30">UTC+05:30</gux-option><gux-option
          value="+05:45">UTC+05:45</gux-option><gux-option value="+06:00">UTC+06:00</gux-option><gux-option
          value="+06:30">UTC+06:30</gux-option><gux-option value="+07:00">UTC+07:00</gux-option><gux-option
          value="+08:00">UTC+08:00</gux-option><gux-option value="+08:45">UTC+08:45</gux-option><gux-option
          value="+09:00">UTC+09:00</gux-option><gux-option value="+09:30">UTC+09:30</gux-option><gux-option
          value="+10:00">UTC+10:00</gux-option><gux-option value="+10:30">UTC+10:30</gux-option><gux-option
          value="+11:00">UTC+11:00</gux-option><gux-option value="+12:00">UTC+12:00</gux-option><gux-option
          value="+12:45">UTC+12:45</gux-option><gux-option value="+13:00">UTC+13:00</gux-option><gux-option
          value="+14:00">UTC+14:00</gux-option>
      </gux-listbox>
    </gux-dropdown>
    <gux-datepicker id="datepicker" style="padding: 8px" mode="range" value="" number-of-months="2"></gux-datepicker>
    <gux-button style="padding: 8px" accent="secondary" onclick="thisMonth()">This Month</gux-button>
    <gux-button style="padding: 8px" accent="secondary" onclick="last30days()">Last 30 Days</gux-button>
    <gux-button style="padding: 8px" accent="primary" onclick="getData()">Search</gux-button>
    <gux-button style="padding: 8px" accent="secondary" onclick="clearData()">Clear</gux-button>
    <gux-button id="download" style="padding: 8px; display: none" accent="ghost"
      onclick="buildPDF()">Download</gux-button>
  </div>
  <div id="spinner" style="padding: 50px; display: none; position: fixed; justify-self: anchor-center">
    <gux-radial-loading id="loading" class="loading" screenreader-text="Loading..."></gux-radial-loading>
  </div>
  <gux-card accent="raised" class="mm-card">
    <h2>Customer Insights Report</h2>
    <p id="createdDate">Created on:</p>
    <div style="display: inline-flex; width: 100%; height: 200px">
      <div>
        <p>Organization:</p>
        <p id="orgName"></p>
        <p>Org ID:</p>
        <p id="orgId"></p>
        <p>Region:</p>
        <p id="region"></p>
      </div>
      <div style="margin-left: 50%">
        <p>StartDate:</p>
        <p id="startDate"></p>
        <p>endDate:</p>
        <p id="endDate"></p>
        <p>Total API Requests:</p>
        <p id="totalAPIs"></p>
      </div>
    </div>
  </gux-card>
  <gux-card accent="raised" class="mm-card">
    <h2>Mean Opinion Score (MOS)</h2>
    <p>
      MOS is a measure of audio quality at a specific measurement point of a voice interaction. Potential measurement
      points are on-premise or cloud-based Edge devices. Values in the MOS column are
      estimated average MOS scores. The estimated average MOS score for a stream is based on codec type, average jitter,
      latency, and packet loss. Each MOS score is a number between 1 (unacceptable)
      and 5 (excellent). Scores below 3.5 generally indicate unacceptable quality. Scores between 4.3 and 5 indicate
      high quality.
    </p>
    <p>MOS is not measured for every interaction.</p>
    <p id="mosLabel" class="mm-center"></p>
  </gux-card>
  <gux-card accent="raised" class="mm-card">
    <h2>R-Factor</h2>
    <p>
      The R-Factor is value derived from metrics such as latency, jitter, and packet loss per ITUâ€‘T Recommendation
      G.107, the R-Factor value helps you quickly assess the quality-of-experience for
      VoIP calls on your network. Typical scores range from 50 (bad) to 90 (excellent).
    </p>
    <p>R-Factor is not available for every interaction.</p>
    <p id="rFactorLabel" class="mm-center"></p>
  </gux-card>
  <gux-card accent="raised" class="mm-card">
    <h2>Inbound Connected Interactions</h2>
    <div style="display: flex; align-items: center; justify-content: center">
      <div style="width: 70%">
        <canvas id="incomingMediaTypes" class="mm-chart"></canvas>
      </div>
      <div id="inboundTable" class="mm-table"></div>
    </div>
  </gux-card>
  <gux-card accent="raised" class="mm-card">
    <h2>Outbound Connected Interactions</h2>
    <div style="display: flex; align-items: center; justify-content: center">
      <div style="width: 70%">
        <canvas id="outgoingMediaTypes" class="mm-chart"></canvas>
      </div>
      <div id="outboundTable" class="mm-table"></div>
    </div>
  </gux-card>
  <gux-card accent="raised" class="mm-card">
    <h2>Recordings</h2>
    <div style="display: flex; align-items: center; justify-content: center">
      <div style="width: 70%">
        <canvas id="recordings" class="mm-chart"></canvas>
      </div>
      <div id="recordingsTable" class="mm-table"></div>
    </div>
  </gux-card>
  <gux-card accent="raised" class="mm-card">
    <h2>Calls Per Day</h2>
    <canvas id="callsPerDay" class="mm-chart"></canvas>
  </gux-card>
  <gux-card accent="raised" class="mm-card">
    <h2>Emails Per Day</h2>
    <canvas id="emailsPerDay" class="mm-chart"></canvas>
  </gux-card>
  <gux-card accent="raised" class="mm-card">
    <h2>Messages Per Day</h2>
    <canvas id="messagesPerDay" class="mm-chart"></canvas>
  </gux-card>
  <gux-card accent="raised" class="mm-card">
    <h2>Callbacks Per Day</h2>
    <canvas id="callbacksPerDay" class="mm-chart"></canvas>
  </gux-card>
  <gux-card accent="raised" class="mm-card">
    <h2>Interactions Per Day</h2>
    <canvas id="interactionsPerDay" class="mm-chart"></canvas>
  </gux-card>
  <gux-card accent="raised" class="mm-card">
    <h2>Users Per Day</h2>
    <canvas id="usersPerDay" class="mm-chart"></canvas>
  </gux-card>
  <gux-card accent="raised" class="mm-card">
    <h2>Organization usage</h2>
    <p>This section shows which features are used in the organization as well as the license required to use this
      feature.</p>
    <p>Data is based on date range selected</p>
    <h3>Flow usage:</h3>
    <div id="flowUsage" class="mm-chart"></div>
    <h3>Routing usage:</h3>
    <div id="routingUsage" class="mm-chart"></div>
    <h3>Object metrics:</h3>
    <div id="objectUsage" class="mm-chart"></div>
  </gux-card>
  <script>
    //MINIFIED
  </script>
</body>
<style>
  body {
    max-width: 900px;
    justify-self: center;
  }

  .mm-center {
    text-align: center;
    padding: 8px;
    width: auto;
  }

  .mm-card {
    margin: 8px;
    width: auto;
  }

  .mm-chart {
    max-width: 100%;
    max-height: 100%;
  }

  .mm-table {
    margin-left: 18px
  }

  /* Styles specifically for printing */
  @media print {
    .content {
      width: auto;
      float: none;
    }

    a::after {
      content: ' (' attr(href) ')';
      font-size: 80%;
    }

    .header {
      display: none !important;
    }

    gux-card {
      page-break-inside: avoid;
      /* Prevent card from breaking across pages */
    }

    img {
      max-width: 100%;
    }
  }
</style>

</html>
